'use strict';

exports.__esModule = true;
exports.isCommandRejectableByPageError = isCommandRejectableByPageError;
exports.canSetDebuggerBreakpointBeforeCommand = canSetDebuggerBreakpointBeforeCommand;
exports.isScreenshotCommand = isScreenshotCommand;
exports.isResizeWindowCommand = isResizeWindowCommand;
exports.isBrowserManipulationCommand = isBrowserManipulationCommand;
exports.isServiceCommand = isServiceCommand;
exports.isExecutableInTopWindowOnly = isExecutableInTopWindowOnly;
exports.isJSExpression = isJSExpression;
exports.isExecutableOnClientCommand = isExecutableOnClientCommand;

var _type = require('./type');

var _type2 = _interopRequireDefault(_type);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const RAW_API_JS_EXPRESSION_TYPE = 'js-expr'; // -------------------------------------------------------------
// WARNING: this file is used by both the client and the server.
// Do not use any browser or node-specific API!
// -------------------------------------------------------------
function isCommandRejectableByPageError(command) {
    return !isObservationCommand(command) && !isBrowserManipulationCommand(command) && !isServiceCommand(command) || isResizeWindowCommand(command) && !isWindowSwitchingCommand(command);
}

function isClientFunctionCommand(command) {
    return command.type === _type2.default.executeClientFunction || command.type === _type2.default.executeSelector;
}

function isObservationCommand(command) {
    return isClientFunctionCommand(command) || command.type === _type2.default.wait || command.type === _type2.default.assertion || command.type === _type2.default.executeExpression;
}

function isWindowSwitchingCommand(command) {
    return command.type === _type2.default.switchToIframe || command.type === _type2.default.switchToMainWindow;
}

function canSetDebuggerBreakpointBeforeCommand(command) {
    return command.type !== _type2.default.debug && !isClientFunctionCommand(command) && !isServiceCommand(command);
}

function isScreenshotCommand(command) {
    return command.type === _type2.default.takeScreenshot || command.type === _type2.default.takeElementScreenshot || command.type === _type2.default.takeScreenshotOnFail;
}

function isResizeWindowCommand(command) {
    return command.type === _type2.default.resizeWindow || command.type === _type2.default.resizeWindowToFitDevice || command.type === _type2.default.maximizeWindow;
}

function isBrowserManipulationCommand(command) {
    return isScreenshotCommand(command) || isResizeWindowCommand(command);
}

function isServiceCommand(command) {
    return command.type === _type2.default.testDone || command.type === _type2.default.showAssertionRetriesStatus || command.type === _type2.default.hideAssertionRetriesStatus || command.type === _type2.default.setBreakpoint || command.type === _type2.default.takeScreenshotOnFail;
}

function isExecutableInTopWindowOnly(command) {
    return command.type === _type2.default.testDone || command.type === _type2.default.switchToMainWindow || command.type === _type2.default.setNativeDialogHandler || command.type === _type2.default.getNativeDialogHistory || command.type === _type2.default.setTestSpeed || command.type === _type2.default.showAssertionRetriesStatus || command.type === _type2.default.hideAssertionRetriesStatus || command.type === _type2.default.setBreakpoint || isBrowserManipulationCommand(command) && command.type !== _type2.default.takeElementScreenshot;
}

function isJSExpression(val) {
    return val !== null && typeof val === 'object' && val.type === RAW_API_JS_EXPRESSION_TYPE && typeof val.value === 'string';
}

function isExecutableOnClientCommand(command) {
    return command.type !== _type2.default.wait && command.type !== _type2.default.setPageLoadTimeout && command.type !== _type2.default.debug && command.type !== _type2.default.useRole && command.type !== _type2.default.assertion && command.type !== _type2.default.executeExpression;
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy90ZXN0LXJ1bi9jb21tYW5kcy91dGlscy5qcyJdLCJuYW1lcyI6WyJpc0NvbW1hbmRSZWplY3RhYmxlQnlQYWdlRXJyb3IiLCJjYW5TZXREZWJ1Z2dlckJyZWFrcG9pbnRCZWZvcmVDb21tYW5kIiwiaXNTY3JlZW5zaG90Q29tbWFuZCIsImlzUmVzaXplV2luZG93Q29tbWFuZCIsImlzQnJvd3Nlck1hbmlwdWxhdGlvbkNvbW1hbmQiLCJpc1NlcnZpY2VDb21tYW5kIiwiaXNFeGVjdXRhYmxlSW5Ub3BXaW5kb3dPbmx5IiwiaXNKU0V4cHJlc3Npb24iLCJpc0V4ZWN1dGFibGVPbkNsaWVudENvbW1hbmQiLCJSQVdfQVBJX0pTX0VYUFJFU1NJT05fVFlQRSIsImNvbW1hbmQiLCJpc09ic2VydmF0aW9uQ29tbWFuZCIsImlzV2luZG93U3dpdGNoaW5nQ29tbWFuZCIsImlzQ2xpZW50RnVuY3Rpb25Db21tYW5kIiwidHlwZSIsImV4ZWN1dGVDbGllbnRGdW5jdGlvbiIsImV4ZWN1dGVTZWxlY3RvciIsIndhaXQiLCJhc3NlcnRpb24iLCJleGVjdXRlRXhwcmVzc2lvbiIsInN3aXRjaFRvSWZyYW1lIiwic3dpdGNoVG9NYWluV2luZG93IiwiZGVidWciLCJ0YWtlU2NyZWVuc2hvdCIsInRha2VFbGVtZW50U2NyZWVuc2hvdCIsInRha2VTY3JlZW5zaG90T25GYWlsIiwicmVzaXplV2luZG93IiwicmVzaXplV2luZG93VG9GaXREZXZpY2UiLCJtYXhpbWl6ZVdpbmRvdyIsInRlc3REb25lIiwic2hvd0Fzc2VydGlvblJldHJpZXNTdGF0dXMiLCJoaWRlQXNzZXJ0aW9uUmV0cmllc1N0YXR1cyIsInNldEJyZWFrcG9pbnQiLCJzZXROYXRpdmVEaWFsb2dIYW5kbGVyIiwiZ2V0TmF0aXZlRGlhbG9nSGlzdG9yeSIsInNldFRlc3RTcGVlZCIsInZhbCIsInZhbHVlIiwic2V0UGFnZUxvYWRUaW1lb3V0IiwidXNlUm9sZSJdLCJtYXBwaW5ncyI6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QixzQkFIdEIsSUFJQXhCLFFBQVFJLElBQVIsS0FBaUIsZUFBS3FCLFlBSnRCLElBS0F6QixRQUFRSSxJQUFSLEtBQWlCLGVBQUtnQiwwQkFMdEIsSUFNQXBCLFFBQVFJLElBQVIsS0FBaUIsZUFBS2lCLDBCQU50QixJQU9BckIsUUFBUUksSUFBUixLQUFpQixlQUFLa0IsYUFQdEIsSUFRQTVCLDZCQUE2Qk0sT0FBN0IsS0FBeUNBLFFBQVFJLElBQVIsS0FBaUIsZUFBS1UscUJBUnRFO0FBU0g7O0FBRU0sU0FBU2pCLGNBQVQsQ0FBeUI2QixHQUF6QixFQUE4QjtBQUNqQyxXQUFPQSxRQUFRLElBQVIsSUFBZ0IsT0FBT0EsR0FBUCxLQUFlLFFBQS9CLElBQTJDQSxJQUFJdEIsSUFBSixLQUFhTCwwQkFBeEQsSUFDQSxPQUFPMkIsSUFBSUMsS0FBWCxLQUFxQixRQUQ1QjtBQUVIOztBQUVNLFNBQVM3QiwyQkFBVCxDQUFzQ0UsT0FBdEMsRUFBK0M7QUFDbEQsV0FBT0EsUUFBUUksSUFBUixLQUFpQixlQUFLRyxJQUF0QixJQUNBUCxRQUFRSSxJQUFSLEtBQWlCLGVBQUt3QixrQkFEdEIsSUFFQTVCLFFBQVFJLElBQVIsS0FBaUIsZUFBS1EsS0FGdEIsSUFHQVosUUFBUUksSUFBUixLQUFpQixlQUFLeUIsT0FIdEIsSUFJQTdCLFFBQVFJLElBQVIsS0FBaUIsZUFBS0ksU0FKdEIsSUFLQVIsUUFBUUksSUFBUixLQUFpQixlQUFLSyxpQkFMN0I7QUFNSCIsImZpbGUiOiJ0ZXN0LXJ1bi9jb21tYW5kcy91dGlscy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIFdBUk5JTkc6IHRoaXMgZmlsZSBpcyB1c2VkIGJ5IGJvdGggdGhlIGNsaWVudCBhbmQgdGhlIHNlcnZlci5cbi8vIERvIG5vdCB1c2UgYW55IGJyb3dzZXIgb3Igbm9kZS1zcGVjaWZpYyBBUEkhXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5pbXBvcnQgVFlQRSBmcm9tICcuL3R5cGUnO1xuXG5jb25zdCBSQVdfQVBJX0pTX0VYUFJFU1NJT05fVFlQRSA9ICdqcy1leHByJztcblxuZXhwb3J0IGZ1bmN0aW9uIGlzQ29tbWFuZFJlamVjdGFibGVCeVBhZ2VFcnJvciAoY29tbWFuZCkge1xuICAgIHJldHVybiAhaXNPYnNlcnZhdGlvbkNvbW1hbmQoY29tbWFuZCkgJiYgIWlzQnJvd3Nlck1hbmlwdWxhdGlvbkNvbW1hbmQoY29tbWFuZCkgJiYgIWlzU2VydmljZUNvbW1hbmQoY29tbWFuZCkgfHxcbiAgICAgICAgICAgaXNSZXNpemVXaW5kb3dDb21tYW5kKGNvbW1hbmQpXG4gICAgICAgICAgICYmICFpc1dpbmRvd1N3aXRjaGluZ0NvbW1hbmQoY29tbWFuZCk7XG59XG5cbmZ1bmN0aW9uIGlzQ2xpZW50RnVuY3Rpb25Db21tYW5kIChjb21tYW5kKSB7XG4gICAgcmV0dXJuIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5leGVjdXRlQ2xpZW50RnVuY3Rpb24gfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLmV4ZWN1dGVTZWxlY3Rvcjtcbn1cblxuZnVuY3Rpb24gaXNPYnNlcnZhdGlvbkNvbW1hbmQgKGNvbW1hbmQpIHtcbiAgICByZXR1cm4gaXNDbGllbnRGdW5jdGlvbkNvbW1hbmQoY29tbWFuZCkgfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLndhaXQgfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLmFzc2VydGlvbiB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUuZXhlY3V0ZUV4cHJlc3Npb247XG59XG5cbmZ1bmN0aW9uIGlzV2luZG93U3dpdGNoaW5nQ29tbWFuZCAoY29tbWFuZCkge1xuICAgIHJldHVybiBjb21tYW5kLnR5cGUgPT09IFRZUEUuc3dpdGNoVG9JZnJhbWUgfHwgY29tbWFuZC50eXBlID09PSBUWVBFLnN3aXRjaFRvTWFpbldpbmRvdztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhblNldERlYnVnZ2VyQnJlYWtwb2ludEJlZm9yZUNvbW1hbmQgKGNvbW1hbmQpIHtcbiAgICByZXR1cm4gY29tbWFuZC50eXBlICE9PSBUWVBFLmRlYnVnICYmICFpc0NsaWVudEZ1bmN0aW9uQ29tbWFuZChjb21tYW5kKSAmJiAhaXNTZXJ2aWNlQ29tbWFuZChjb21tYW5kKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU2NyZWVuc2hvdENvbW1hbmQgKGNvbW1hbmQpIHtcbiAgICByZXR1cm4gY29tbWFuZC50eXBlID09PSBUWVBFLnRha2VTY3JlZW5zaG90IHx8XG4gICAgICAgICAgIGNvbW1hbmQudHlwZSA9PT0gVFlQRS50YWtlRWxlbWVudFNjcmVlbnNob3QgfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLnRha2VTY3JlZW5zaG90T25GYWlsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNSZXNpemVXaW5kb3dDb21tYW5kIChjb21tYW5kKSB7XG4gICAgcmV0dXJuIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5yZXNpemVXaW5kb3cgfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLnJlc2l6ZVdpbmRvd1RvRml0RGV2aWNlIHx8XG4gICAgICAgICAgIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5tYXhpbWl6ZVdpbmRvdztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQnJvd3Nlck1hbmlwdWxhdGlvbkNvbW1hbmQgKGNvbW1hbmQpIHtcbiAgICByZXR1cm4gaXNTY3JlZW5zaG90Q29tbWFuZChjb21tYW5kKSB8fCBpc1Jlc2l6ZVdpbmRvd0NvbW1hbmQoY29tbWFuZCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1NlcnZpY2VDb21tYW5kIChjb21tYW5kKSB7XG4gICAgcmV0dXJuIGNvbW1hbmQudHlwZSA9PT0gVFlQRS50ZXN0RG9uZSB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUuc2hvd0Fzc2VydGlvblJldHJpZXNTdGF0dXMgfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLmhpZGVBc3NlcnRpb25SZXRyaWVzU3RhdHVzIHx8XG4gICAgICAgICAgIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5zZXRCcmVha3BvaW50IHx8XG4gICAgICAgICAgIGNvbW1hbmQudHlwZSA9PT0gVFlQRS50YWtlU2NyZWVuc2hvdE9uRmFpbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRXhlY3V0YWJsZUluVG9wV2luZG93T25seSAoY29tbWFuZCkge1xuICAgIHJldHVybiBjb21tYW5kLnR5cGUgPT09IFRZUEUudGVzdERvbmUgfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLnN3aXRjaFRvTWFpbldpbmRvdyB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUuc2V0TmF0aXZlRGlhbG9nSGFuZGxlciB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUuZ2V0TmF0aXZlRGlhbG9nSGlzdG9yeSB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUuc2V0VGVzdFNwZWVkIHx8XG4gICAgICAgICAgIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5zaG93QXNzZXJ0aW9uUmV0cmllc1N0YXR1cyB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUuaGlkZUFzc2VydGlvblJldHJpZXNTdGF0dXMgfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLnNldEJyZWFrcG9pbnQgfHxcbiAgICAgICAgICAgaXNCcm93c2VyTWFuaXB1bGF0aW9uQ29tbWFuZChjb21tYW5kKSAmJiBjb21tYW5kLnR5cGUgIT09IFRZUEUudGFrZUVsZW1lbnRTY3JlZW5zaG90O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNKU0V4cHJlc3Npb24gKHZhbCkge1xuICAgIHJldHVybiB2YWwgIT09IG51bGwgJiYgdHlwZW9mIHZhbCA9PT0gJ29iamVjdCcgJiYgdmFsLnR5cGUgPT09IFJBV19BUElfSlNfRVhQUkVTU0lPTl9UWVBFICYmXG4gICAgICAgICAgIHR5cGVvZiB2YWwudmFsdWUgPT09ICdzdHJpbmcnO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNFeGVjdXRhYmxlT25DbGllbnRDb21tYW5kIChjb21tYW5kKSB7XG4gICAgcmV0dXJuIGNvbW1hbmQudHlwZSAhPT0gVFlQRS53YWl0ICYmXG4gICAgICAgICAgIGNvbW1hbmQudHlwZSAhPT0gVFlQRS5zZXRQYWdlTG9hZFRpbWVvdXQgJiZcbiAgICAgICAgICAgY29tbWFuZC50eXBlICE9PSBUWVBFLmRlYnVnICYmXG4gICAgICAgICAgIGNvbW1hbmQudHlwZSAhPT0gVFlQRS51c2VSb2xlICYmXG4gICAgICAgICAgIGNvbW1hbmQudHlwZSAhPT0gVFlQRS5hc3NlcnRpb24gJiZcbiAgICAgICAgICAgY29tbWFuZC50eXBlICE9PSBUWVBFLmV4ZWN1dGVFeHByZXNzaW9uO1xufVxuIl19
